BEGIN_DEFAULT_CONFIG
Flags:
Files:          $TESTNAME$.upc
DynamicThreads: $DEFAULT$
StaticThreads:  $DEFAULT$
CompileResult:  pass
PassExpr:       ^done.
FailExpr:       ERROR
ExitCode:       0
BuildCmd:       upcc
AppArgs:        
TimeLimit:      $DEFAULT$
END_DEFAULT_CONFIG


# ------------------------------------------------------------
TestName: allocperf
AppArgs: 100

TestName: alloc_time
AppArgs: 100 1024
BenchmarkResult: All Alloc with \S+ THREADS, \S+ block size: (\S+) (us)

TestName: barrierperf
BenchmarkResult: Avg Anon. Barrier latency:\s+(\S+) (us)

TestName: bupc_ptradd
RequireFeature: upc_ptradd

TestName: bupc_thread_dist
RequireFeature: upc_thread_distance

TestName: bupc_tick
RequireFeature: upc_tick

TestName: bupc_memperf
RequireFeature: upc_tick,upc_memcpy_async
KnownFailure: compile-warning ; cc_pathscale ; bug1199 (pointer from integer warnings)

TestName: bupc_semperf
AppArgs: 1000 100 65536
RequireFeature: upc_tick,upc_sem

TestName: gasp_test
RequireFeature: pupc

TestName: Edmiston
AppArgs: 1000 1000
KnownFailure:   run-all ; trans_opt ; bug1505 (--opt-specific runtime failures on stable translator)
RequireFeature: upc_tick

TestName: gups_pair
AppArgs: 10 1024

TestName: laplacian
Flags: -DROWS=16 -DCOLS=16
AppArgs: 10 
DynamicThreads: 0
BenchmarkResult: time: (\S+) (us/iter)

TestName: ptrmath-volatile
AppArgs: 1000
#KnownFailure: bug469 (Bad codegen for ptrmath-volatile on 64-bit)
#KnownFailure: bug827 (codegen regression on 64-bit regarding pointer-int casts)

TestName: scale-poly
AppArgs: 100 1024 8
PassExpr: ^output
BenchmarkResult: 0: Performance of scale with 50 . of local accesses out of \S+ iterations: (\S+) (us/iter)
#KnownFailure: bug446 (bad codegen on benchmarks/scale-poly)

TestName: memcpy_async
RequireFeature: upc_memcpy_async
Flags: -DBUPC_USE_UPC_NAMESPACE=1
PassExpr: ^done.
FailExpr: ERROR

TestName: memcpy
RequireFeature: upc_memcpy_async,upc_memcpy_vis
PassExpr: ^done.
FailExpr: ERROR
#KnownFailure: bug575 
#KnownFailure: bug829 (32-bit codegen regression on memcpy and memcpy2)
#KnownFailure: run-all ; os_darwin && cc_xlc && nodebug && pthreads ; bug926 (Unstable runtime behavior on OSX/XLC/ndebug)
KnownFailure: compile-failure ; cpu_sparc && cc_gnu && nodebug ; bug1497 (benchmarks/memcpy causes gcc to die on Solaris/sparc)

TestName: memcpy2
RequireFeature: upc_memcpy_async,upc_memcpy_vis
PassExpr: ^done.
FailExpr: ERROR
#KnownFailure: bug829 (32-bit codegen regression on memcpy and memcpy2)
#KnownFailure: run-all ; os_darwin && cc_xlc && nodebug && pthreads ; bug926 (Unstable runtime behavior on OSX/XLC/ndebug)

TestName: stream-relaxed
Files: stream.c
Flags: -DELEM_T=double -DUSE_SHARED -DUSE_RELAXED -DARRAY_SIZE=100000
SaveOutput: 1
PassExpr: ^done.
#KnownFailure:   compile-warning ;; bug967 (Bad codegen for volatile qualifiers)

TestName: stream-strict
Files: stream.c
Flags: -DELEM_T=double -DUSE_SHARED -DUSE_STRICT -DARRAY_SIZE=100000
SaveOutput: 1
PassExpr: ^done.
#KnownFailure:   compile-warning ;; bug967 (Bad codegen for volatile qualifiers)

TestName: strided-comm
SaveOutput: 1
AppArgs: 1 100 1024 4096 100
RequireFeature: upc_memcpy_async,upc_memcpy_vis
PassExpr: ^done.

TestName: touchperf
AppArgs: A 4000000 100
PassExpr: ^done.
RequireFeature: upc_tick
KnownFailure: run-all ; os_osf ; bug 1230 (Tru64 translator breaks toupper)

TestName: lockperf
BenchmarkResult: upc_lock/upc_unlock, local uncontended\s*:\s*Total=\s*\S+\s+\S+\s+Avg/Min/Max=\s*(\S+)\s+\S+\s+\S+\s+(us)
RequireFeature: upc_collective
PassExpr: ^done.

TestName: upc_io_test
RequireFeature: upc_io
PassExpr: ^SUCCESS
FailExpr: ERROR
#KnownFailure: bug818 ( bogus translator warnings on upc_io_test)
#KnownFailure: run-all ; os_darwin && cc_xlc && nodebug && pthreads ; bug926 (Unstable runtime behavior on OSX/XLC/ndebug)
KnownFailure: compile-warning ; cpu_64 ; bug819 (bogus warning on upc_io_test/64)
#KnownFailure: compile-failure ; cpu_64 ; bug930 (Regression on upc_io_test/64)
KnownFailure: run-all ; conduit_gm || conduit_vapi || conduit_ibv ; bug955 (gm/vapi/ibv failures on upc_io_test - firehose mishandles free)

TestName: stream_mtu
SaveOutput: 1
PassExpr: ^done

TestName: thread-scale
Files:  $TESTNAME$.c
AppArgs: 1000000

TestName: natural_ring_mtu
SaveOutput: 1
PassExpr: ^done

TestName: fetchadd_perf
SaveOutput: 1
PassExpr: ^done
RequireFeature: upc_atomics,upc_tick
